(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{489:function(t,a,s){"use strict";s.r(a);var e=s(8),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"このページでわかること"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#このページでわかること"}},[t._v("#")]),t._v(" このページでわかること")]),t._v(" "),s("ul",[s("li",[t._v("Travis CIの基礎")]),t._v(" "),s("li",[t._v("markdownファイルをpushされたとき、Vuepressサイトが自動ビルドする手順")])]),t._v(" "),s("h2",{attrs:{id:"前提条件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前提条件"}},[t._v("#")]),t._v(" 前提条件")]),t._v(" "),s("p",[t._v("以下の作業が完了していること"),s("br"),t._v(" "),s("RouterLink",{attrs:{to:"/posts/2019/06/15/vuepress-introduction.html"}},[t._v("vuepressで作った静的サイトをGithub pagesで公開するまで")])],1),t._v(" "),s("h2",{attrs:{id:"travis-ciとは"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#travis-ciとは"}},[t._v("#")]),t._v(" Travis CIとは")]),t._v(" "),s("p",[t._v("Githubのpublicリポジトリなら無料で利用できるCI/CDサービス")]),t._v(" "),s("blockquote",[s("h4",{attrs:{id:"ci-cd-継続的インテグレーション-デリバリー-とは"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ci-cd-継続的インテグレーション-デリバリー-とは"}},[t._v("#")]),t._v(" CI/CD(継続的インテグレーション/デリバリー)とは")]),t._v(" "),s("p",[t._v("ビルドやテスト、デプロイを自動化してバグの早期発見、開発効率の工場を図る仕組みのこと。")])]),t._v(" "),s("p",[s("code",[t._v(".travis.yml")]),t._v("をGithubリポジトリに含めるだけでジョブの設定が可能。")]),t._v(" "),s("h2",{attrs:{id:"travis-ymlについて"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#travis-ymlについて"}},[t._v("#")]),t._v(" .travis.ymlについて")]),t._v(" "),s("h3",{attrs:{id:"ジョブのライフサイクル"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ジョブのライフサイクル"}},[t._v("#")]),t._v(" ジョブのライフサイクル")]),t._v(" "),s("p",[t._v("ライフサイクルは以下のフェーズで構成されている。\n上から順に実行されるので、好きなフェーズをチョイスしてymlに書く。")]),t._v(" "),s("ol",[s("li",[t._v("[任意] "),s("code",[t._v("apt addons")])]),t._v(" "),s("li",[t._v("[任意] "),s("code",[t._v("cache components")])]),t._v(" "),s("li",[s("code",[t._v("before_install")])]),t._v(" "),s("li",[s("code",[t._v("install")])]),t._v(" "),s("li",[s("code",[t._v("before_script")])]),t._v(" "),s("li",[s("code",[t._v("script")])]),t._v(" "),s("li",[t._v("[任意] "),s("code",[t._v("before_cache")]),t._v(" (for cleaning up cache)")]),t._v(" "),s("li",[s("code",[t._v("after_success")]),t._v(" or "),s("code",[t._v("after_failure")])]),t._v(" "),s("li",[t._v("[任意] "),s("code",[t._v("before_deploy")])]),t._v(" "),s("li",[t._v("[任意] "),s("code",[t._v("deploy")])]),t._v(" "),s("li",[t._v("[任意] "),s("code",[t._v("after_deploy")])]),t._v(" "),s("li",[s("code",[t._v("after_script")])])]),t._v(" "),s("h2",{attrs:{id:"導入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#導入"}},[t._v("#")]),t._v(" 導入")]),t._v(" "),s("h3",{attrs:{id:"_1-アカウントを作成する"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-アカウントを作成する"}},[t._v("#")]),t._v(" 1. アカウントを作成する")]),t._v(" "),s("p",[t._v("Githubアカウントでログイン可能。")]),t._v(" "),s("h3",{attrs:{id:"_2-リポジトリを有効化する"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-リポジトリを有効化する"}},[t._v("#")]),t._v(" 2. リポジトリを有効化する")]),t._v(" "),s("p",[t._v("右上のSettingsから設定画面を開き、デプロイ自動化したいリポジトリを有効化する。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/img/vuepress-automate-deployment-with-travis-1.png",alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/img/vuepress-automate-deployment-with-travis-2.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"_3-githubのアクセストークンを取得してtravisに登録する。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-githubのアクセストークンを取得してtravisに登録する。"}},[t._v("#")]),t._v(" 3. GIthubのアクセストークンを取得してTravisに登録する。")]),t._v(" "),s("ol",[s("li",[t._v("Githubのユーザ設定 > Developer settings > Personal access tokens画面を開く")]),t._v(" "),s("li",[t._v("Generate new tokenを押す。")]),t._v(" "),s("li",[t._v("Noteに好きな識別子を入力し、public_repoにチェックを入れる。\n"),s("img",{attrs:{src:"/assets/img/vuepress-automate-deployment-with-travis-3.png",alt:""}})]),t._v(" "),s("li",[t._v("緑色の部分にアクセストークンが表示されるのでコピーする。\n"),s("img",{attrs:{src:"/assets/img/vuepress-automate-deployment-with-travis-4.png",alt:""}})]),t._v(" "),s("li",[t._v("Travis CIのリポジトリ設定画面を開き、"),s("code",[t._v("Environment Variables")]),t._v("の"),s("code",[t._v("name")]),t._v("を好きな文字列に、"),s("code",[t._v("value")]),t._v("を先ほどコピーしたtokenを入力する。\n"),s("img",{attrs:{src:"/assets/img/vuepress-automate-deployment-with-travis-5.png",alt:""}})])]),t._v(" "),s("h3",{attrs:{id:"_4-travis-ymlを作成する"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-travis-ymlを作成する"}},[t._v("#")]),t._v(" 4. "),s("code",[t._v(".travis.yml")]),t._v("を作成する")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" npm install\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" npm run build\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("deploy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("provider")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pages\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("skip_cleanup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("github_token")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $github_token\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("keep_history")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("local-dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" .vuepress/dist\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" master\n")])])]),s("h3",{attrs:{id:"_5-完了"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-完了"}},[t._v("#")]),t._v(" 5. 完了")]),t._v(" "),s("p",[s("code",[t._v(".travis.yml")]),t._v("をpushした瞬間から、自動デプロイが動くようになる。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/img/vuepress-automate-deployment-with-travis-6.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"今回のソース"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#今回のソース"}},[t._v("#")]),t._v(" 今回のソース")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/qnaiv/automate-deploy-with-travis",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/qnaiv/automate-deploy-with-travis"),s("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=r.exports}}]);